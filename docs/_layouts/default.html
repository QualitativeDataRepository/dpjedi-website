<!DOCTYPE html>
<!--
	Horizons by TEMPLATED
	templated.co @templatedco
	Released for free under the Creative Commons Attribution 3.0 license (templated.co/license)
-->
<html lang="en">

<head>
  <title>{{ page.title }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="description" content="Homepage for the Data-PASS JEDI project" />
  <meta name="keywords" content="scientific journals, research transparency" />
  <!--[if lte IE 8
      ]><script src="{{ site.baseurl }}/assets/css/ie/html5shiv.js"></script
    ><![endif]-->
  <script src="{{ site.baseurl }}/assets/js/jquery.min.js"></script>
  <script src="{{ site.baseurl }}/assets/js/jquery.dropotron.min.js"></script>
  <script src="{{ site.baseurl }}/assets/js/skel.min.js"></script>
  <script src="{{ site.baseurl }}/assets/js/skel-layers.min.js"></script>
  <script src="{{ site.baseurl }}/assets/js/init.js"></script>

  <!-- Bootstrap JS bundle CDN inclusion -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>
  <!-- Bootstrap CSS CDN inclusion -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
  <!--Futura PT font via Adobe -->
  <link rel="stylesheet" href="https://use.typekit.net/jvy0vlc.css" />

  <!-- Favicons -->
  <link rel="apple-touch-icon" sizes="180x180" href="{{ site.baseurl }}/assets/images/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="{{ site.baseurl }}/assets/images/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="{{ site.baseurl }}/assets/images/favicon-16x16.png" />
  <link rel="manifest" href="{{ site.baseurl }}/assets/images/site.webmanifest" />
  <meta name="msapplication-TileColor" content="#da532c" />
  <meta name="theme-color" content="#ffffff" />

  <noscript>
    <link rel="stylesheet" href="{{ site.baseurl }}/assets/css/skel.css" />
    <link rel="stylesheet" href="{{ site.baseurl }}/assets/css/style.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
  </noscript>
  <!--[if lte IE 8
      ]><link rel="stylesheet" href="{{ site.baseurl }}/assets/css/ie/v8.css"
    /><![endif]-->
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-TT1VGTLKX5"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());
    gtag("config", "G-TT1VGTLKX5");
  </script>
  {% include analytics.html %}
</head>

<body>
  <a class="skip-to-content" href="#main">Skip navigation</a>
  {{ content }}
  <!-- Footer -->
  <footer role="contentinfo">
    <div id="footer" class="text-light py-4">
      <div class="container">
        <section>
          <div class="row align-items-center">
            <div class="col-md-9">
              <header class="major">
                <h2>
                  <a href="http://www.data-pass.org" target="_blank" class="text-light">Data-PASS</a>
                </h2>
                <p class="byline">
                  JEDI is an initiative of Data-PASS, the Data Preservation
                  Alliance for the Social Sciences
                </p>
              </header>
              <ul class="list-unstyled contact">
                <li>
                  <span class="homepage">Homepage:</span>
                  <span><a href="http://www.data-pass.org" target="_blank"
                      class="text-light">www.data-pass.org</a></span>
                </li>
                <li>
                  <span class="mail">Email:</span>
                  <span><a href="mailto:datapassjedi@gmail.com" class="text-light">datapassjedi@gmail.com</a></span>
                </li>
              </ul>
            </div>
            <div class="col-md-3 text-md-right text-center">
              <img src="{{ site.baseurl }}/assets/images/datapass-logo.jpg" alt="DataPASS Logo" class="img-fluid" />
            </div>
          </div>
        </section>
      </div>

      <!-- Copyright -->
      <div class="copyright text-light text-center py-3 mt-4">
        Design:
        <a href="http://templated.co" target="_blank" class="text-light">TEMPLATED</a>
        | Image:
        <a href="https://commons.wikimedia.org/wiki/File:Long_Room_Interior,_Trinity_College_Dublin,_Ireland_-_Diliff.jpg"
          target="_blank" class="text-light">David Iliff</a>
        (<a href="https://creativecommons.org/licenses/by-sa/4.0/deed.en" target="_blank"
          class="text-light">CC-BY-SA</a>) | Jekyll Template:
        <a href="http://cloudcannon.com" target="_blank" class="text-light">Cloud Cannon</a>
        | Content:
        <a href="http://www.data-pass.org" target="_blank" class="text-light">Data-PASS</a>
      </div>
    </div>
  </footer>
  <a href="#top" id="back-to-top" class="back-to-top"> &#8679; </a>
  <script>

    document.addEventListener("scroll", function () {
      const backToTopButton = document.getElementById("back-to-top");
    });
    document.addEventListener("DOMContentLoaded", function () {


      function setMenuItem() {
        const path = window.location.pathname;
        console.log('path:', path)
      }

      // Smooth scroll to the anchor if there's a hash in the URL
      function scrollToAnchor() {
        const hash = window.location.hash;

        console.log('hash:', hash)

        if (hash) {
          const target = document.querySelector(hash);

          if (target) {
            setTimeout(function () {
              target.scrollIntoView({ behavior: "smooth" });
            }, 100);
          }
        } else {

          const firstH2 = document.querySelector("h2[id]");
          console.log("firstH2", firstH2)
          if (firstH2) {
            setTimeout(function () {
              firstH2.scrollIntoView({ behavior: "smooth" });
              if (firstH2.id !== "heading1") {
                window.history.pushState(null, null, `#${firstH2.id}`);
              } else {

              }
            }, 100);
          }
        }
      }

      setMenuItem();
      scrollToAnchor();


      window.addEventListener("hashchange", scrollToAnchor);

      if (window.location.hash) {
        const anchor = document.querySelector(window.location.hash);
        if (anchor) {

          anchor.scrollIntoView({ behavior: "smooth" });
        }
      }

      const sidebarLinks = document.querySelectorAll("#sidebarMenu a");
      const accordionButtons = document.querySelectorAll(".accordion-button");
      const allAccordionItems = document.querySelectorAll(".accordion-collapse");

      // Remove 'active' classes from links and accordion buttons
      function removeActiveClasses() {
        sidebarLinks.forEach((link) => link.classList.remove("active"));
        accordionButtons.forEach((button) => button.classList.remove("active"));
      }

      // Collapse all accordion items
      function collapseAllAccordions() {
        allAccordionItems.forEach((accordion) => {
          //console.log("accordion: ", accordion)
          accordion.classList.remove("show"); // Collapse the accordion
          accordion.previousElementSibling.setAttribute("aria-expanded", "false"); // Update aria-expanded
        });
      }

      // function getPathName() {

      //     const path = window.location.pathname;
      //     let id = path.split('/')[3];
      //     console.log('getPathName id: ', id)
      //     return id

      // }

      // const id = getPathName()

      // const slug = "{{ page.slug }}"

      // function activateAccordion(id) {
      //   console.log("activateAccordion id:: ", id)
      //   const target = document.querySelector(`#${id}`);
      //   console.log('target: ', target)
      //   target.scrollIntoView({ behavior: "smooth" });
      //   allAccordionItems.forEach((acccordion) => {
      //     console.log('acccordion: ', acccordion)
      //   })
      // }

      // activateAccordion(slug)

      // Check if the clicked link is a main menu link or submenu link
      function isMainMenuItem(link) {
        return true
        // return link.closest('.accordion-collapse') === null; // It's a main menu item if it's not inside an accordion-collapse
      }

      function setActiveLink() {
        let currentSection = "";

        sidebarLinks.forEach((link) => {
          const section = document.querySelector(link.getAttribute("href"));

          if (section) {
            const sectionTop = section.getBoundingClientRect().top + window.scrollY;

            if (window.scrollY >= sectionTop - 100 && window.scrollY < sectionTop + section.offsetHeight) {
              currentSection = link.getAttribute("href");
            }
          }
        });

        if (currentSection) {
          removeActiveClasses();
          const activeLink = document.querySelector(`#sidebarMenu a[href="${currentSection}"]`);
          const activeButton = document.querySelector(
            `.accordion-button[data-bs-target="#collapse${currentSection.substring(1)}"]`
          );

          if (activeLink) {
            activeLink.classList.add("active");
          }

          if (activeButton) {
            activeButton.classList.add("active");
          }
        }
      }

      // Add click event listener to sidebar links
      sidebarLinks.forEach((link) => {
        link.addEventListener("click", function (event) {
          // Only collapse if it's a main menu item
          // if (isMainMenuItem(link)) {
          //   collapseAllAccordions(); // Collapse all open accordions when a main menu link is clicked
          // }
        });
      });

      // Add click event listener to accordion buttons
      accordionButtons.forEach((button) => {
        button.addEventListener("click", function () {
          const targetId = button.getAttribute("data-bs-target").replace("#collapse", "");
          const firstSubItem = document.querySelector(`#collapse${targetId} a`);
          const firstAnchor = document.querySelector(firstSubItem.getAttribute("href"));
          console.log("firstAnchor: ", firstAnchor)
          if (firstSubItem && firstAnchor) {
            setTimeout(function () {
              firstAnchor.scrollIntoView({ behavior: "smooth" });

              window.history.pushState(null, null, firstSubItem.getAttribute("href"));

              removeActiveClasses();
              button.classList.add("active");
              firstSubItem.classList.add("active");

              setActiveLink();
            }, 300);
          }
        });
      });

      window.addEventListener("scroll", setActiveLink);
      setActiveLink();
    });

    document.addEventListener("DOMContentLoaded", function () {

      let subMenuAnchorClick = false

      subMenuAnchor.addEventListener('click', function (event) {
        subMenuAnchorClick = true
      })

      // Function to hide all sections and display only the one with the matching id
      function displaySection(sectionId) {

        if (!subMenuAnchorClick) {
          // Hide all sections
          const sections = document.querySelectorAll('#contentWrapper > div');
          sections.forEach(function (section) {
            section.style.display = 'none';
          });
        }

        // Find and display the section with the matching id
        const selectedSection = document.getElementById(sectionId);
        if (selectedSection) {
          selectedSection.style.display = 'block';
        } else {
          console.log('Section not found: ' + sectionId);  // Log if the section is not found
        }
      }

      // Get all anchor tags that are linked to sections
      const anchors = document.querySelectorAll('a[href^="#"]');

      // Check if there's a hash in the URL on page load
      let hash = window.location.hash;
      hash = hash.substring(1); // Remove the # from the hash value

      // Log the hash for debugging
      console.log("Current hash on load: ", hash);

      // Handle click events on anchor tags
      anchors.forEach(function (anchor) {
        anchor.addEventListener('click', function (event) {
          // Prevent default anchor click behavior
          event.preventDefault();

          // Extract the section id from the href attribute (remove the #)
          const sectionId = this.getAttribute('href').substring(1);

          // Update the URL hash without reloading the page
          window.history.pushState(null, null, `#${sectionId}`);

          // Display the corresponding section
          displaySection(sectionId);
        });
      });

      // If a hash exists in the URL, display the corresponding section
      if (hash !== "") {
        displaySection(hash);
      } else {
        // If no hash is present, display the first section by default
        if (anchors.length > 0) {
          const firstSectionId = anchors[0].getAttribute('href').substring(1);
          displaySection(firstSectionId);
        }
      }
    });
  </script>



  <script src="{{ site.baseurl }}/assets/js/marked.min.js"></script>
</body>

</html>